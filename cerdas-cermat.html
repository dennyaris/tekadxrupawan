<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Form Pendaftaran - Cerdas Cermat</title>
  <link rel="stylesheet" href="assets/style.css"/>
  <script>
    // Mencegah klik kanan
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
      return false;
    });
    
    // Mencegah shortcut keyboard untuk inspect element
    document.addEventListener('keydown', function(e) {
      // F12
      if(e.keyCode == 123) {
        e.preventDefault();
        return false;
      }
      
      // Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C
      if(e.ctrlKey && e.shiftKey && (e.keyCode == 73 || e.keyCode == 74 || e.keyCode == 67)) {
        e.preventDefault();
        return false;
      }
      
      // Ctrl+U (view source)
      if(e.ctrlKey && e.keyCode == 85) {
        e.preventDefault();
        return false;
      }
    });
    
    // Deteksi DevTools - versi yang lebih baik untuk mobile
    function detectDevTools() {
      // Nonaktifkan deteksi pada perangkat mobile
      if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
        return; // Skip deteksi pada perangkat mobile
      }
      
      // Untuk desktop, gunakan threshold yang lebih besar
      const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
      const widthThreshold = isSafari ? 300 : 160;
      const heightThreshold = isSafari ? 300 : 160;
      
      const widthDiff = window.outerWidth - window.innerWidth;
      const heightDiff = window.outerHeight - window.innerHeight;
      
      if (widthDiff > widthThreshold || heightDiff > heightThreshold) {
        document.body.innerHTML = '<div style="text-align:center;padding:50px;"><h1>Akses Ditolak</h1><p>Tindakan tidak diizinkan.</p></div>';
      }
    }
    
    // Tunda eksekusi untuk memastikan halaman dimuat terlebih dahulu
    setTimeout(function() {
      window.addEventListener('resize', detectDevTools);
      setInterval(detectDevTools, 1000);
    }, 1500);
  </script>
</head>
<body oncontextmenu="return false" ondragstart="return false">
  <div class="container">
    <div class="card">
      <div class="header">
        <h1>ðŸ“š Cerdas Cermat</h1>
        <p>Form pendaftaran tim lomba Cerdas Cermat SMA/Sederajat berlaku 1 tim beranggotakan 5 orang.</p>
      </div>
      <form class="form" id="form-cc">
        <div class="notice"> <span class="req">*</span> wajib diisi.</div>
        <div class="grid">
          <div>
            <label>Asal Sekolah <span class="req">*</span></label>
            <input type="text" name="asal_sekolah" required placeholder="SMA / Sederajat ...">
          </div>
          <div>
            <label>Kota/Kab <span class="req">*</span></label>
            <input type="text" name="kota_kab" required placeholder="Contoh: Tangerang">
          </div>

          <div class="row-full">
            <label>Nama Tim <span class="req">*</span></label>
            <input type="text" name="nama_tim" required placeholder="Contoh: Tim Aksara">
          </div>

          <div class="row-full"><label>Nama Lengkap Anggota Tim</label></div>
          <div><input type="text" name="anggota_1" placeholder="Anggota 1 (wajib)" required></div>
          <div><input type="text" name="anggota_2" placeholder="Anggota 2 (wajib)" required></div>
          <div><input type="text" name="anggota_3" placeholder="Anggota 3 (wajib)" required></div>
          <div><input type="text" name="anggota_4" placeholder="Anggota 4"></div>
          <div><input type="text" name="anggota_5" placeholder="Anggota 5"></div>

          <div style="grid-column: 1/2;">
            <label>Nama PIC Guru <span class="req">*</span></label>
            <input type="text" name="nama_pic_guru" required placeholder="Nama guru pendamping">
          </div>
          <div style="grid-column: 2/3;">
            <label>Kontak PIC Guru <span class="req">*</span></label>
            <input type="tel" name="kontak_pic_guru" inputmode="tel" pattern="[0-9+ ]{8,}" required placeholder="08xxx / +62xxx">
            <div class="help">Gunakan angka, spasi, dan tanda + saja.</div>
          </div>

          <div style="grid-column: 1/2;">
            <label>Kontak Perwakilan Anggota Tim <span class="req">*</span></label>
            <input type="tel" name="kontak_perwakilan" inputmode="tel" pattern="[0-9+ ]{8,}" required placeholder="08xxx / +62xxx">
          </div>
          <div style="grid-column: 2/3;">
            <label>Jumlah Supporter Yang Hadir</label>
            <input type="text" name="jumlah_supporter" min="0" placeholder="Contoh: 3">
          </div>
        </div>

        <div class="footer-note">Dengan mengirim formulir ini, Anda menyetujui data digunakan untuk keperluan administrasi lomba.</div>
        <div class="actions" style="justify-content: center; flex-wrap: wrap;">
          <button type="submit" class="btn-primary" style="margin: 0 auto; min-width: 200px;">Kirim Pendaftaran</button>
        </div>
      </form>
    </div>
  </div>

  <script src="assets/script.js"></script>
  <script>
  (function(){
    const form = document.getElementById('form-cc');
    form.addEventListener('submit', function(e){
      e.preventDefault();
      if(!form.reportValidity()) return;

      const payload = {
        eventType: 'cerdas_cermat',
        asal_sekolah: form.asal_sekolah.value.trim(),
        kota_kab: form.kota_kab.value.trim(),
        nama_tim: form.nama_tim.value.trim(),
        anggota_1: form.anggota_1.value.trim(),
        anggota_2: form.anggota_2.value.trim(),
        anggota_3: form.anggota_3.value.trim(),
        anggota_4: form.anggota_4.value.trim(),
        anggota_5: form.anggota_5.value.trim(),
        nama_pic_guru: form.nama_pic_guru.value.trim(),
        kontak_pic_guru: telSanitize(form.kontak_pic_guru.value),
        kontak_perwakilan: telSanitize(form.kontak_perwakilan.value),
        submitted_at: new Date().toISOString()
      };
      submitToSheet(payload, form);
    });
  })();
  </script>
</body>
</html>
